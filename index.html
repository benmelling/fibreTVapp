<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FibreTV M3 Mockup V4 (Fixed Profiles)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Standard Mode Colors */
            --bg-color: #121212;
            --surface-color: #1E1E1E;
            --surface-variant: #2C2C2C;
            --primary-accent: #FF9800; /* Orange */
            --text-primary: #E6E1E5;
            --text-secondary: #Cac4d0;
            
            --card-radius: 16px;
            --menu-radius: 12px;
        }

        /* Kids Mode Override Class */
        body.kids-mode {
            --primary-accent: #FFEB3B; /* Yellow */
            --bg-color: #1a1a00; /* Very dark yellow/black tint */
        }

        * { box-sizing: border-box; }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Roboto', sans-serif;
            display: flex; height: 100vh; overflow: hidden;
            transition: background-color 0.5s ease;
        }

        /* --- PROFILE OVERLAY --- */
        #profile-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.3s ease;
        }
        .profile-grid { display: flex; gap: 3rem; margin-top: 3rem; }
        .profile-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: transform 0.2s; }
        .profile-avatar {
            width: 140px; height: 140px; border-radius: 50%;
            background: #333; display: flex; justify-content: center; align-items: center;
            font-size: 3.5rem; color: #aaa; border: 4px solid transparent;
            margin-bottom: 1rem;
        }
        .profile-name { font-size: 1.3rem; font-weight: 500; }
        
        /* Kids Style */
        .profile-item[data-profile="Kids"] .profile-avatar {
            background: linear-gradient(135deg, #FFEB3B, #FF9800);
            color: #222;
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 96px; background-color: var(--surface-color);
            display: flex; flex-direction: column; align-items: center;
            padding-top: 2rem; z-index: 100; border-right: 1px solid #333;
        }
        .current-profile-icon {
            width: 50px; height: 50px; border-radius: 50%;
            background-color: #444; color: white;
            display: flex; justify-content: center; align-items: center;
            margin-bottom: 2rem; font-size: 1.2rem; cursor: pointer;
            border: 2px solid transparent;
        }

        .menu-item {
            width: 64px; height: 64px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            margin-bottom: 1rem; border-radius: var(--menu-radius);
            color: var(--text-secondary); cursor: pointer;
            font-size: 0.75rem; font-weight: 500; text-align: center;
            transition: all 0.2s;
        }
        .menu-item i { font-size: 1.5rem; margin-bottom: 6px; }
        .menu-item.active-tab { 
            color: var(--primary-accent); 
            background-color: rgba(255, 255, 255, 0.05); 
        }
        .settings-spacer { flex-grow: 1; }

        /* --- FOCUS RING (Orange/Yellow) --- */
        .focusable:focus, .focused {
            outline: none;
            border: 4px solid var(--primary-accent) !important;
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.7);
            z-index: 10; color: white;
        }
        .profile-avatar.focused { border-color: var(--primary-accent) !important; transform: scale(1.1); }
        .current-profile-icon.focused { border-color: var(--primary-accent) !important; }

        /* --- MAIN CONTENT --- */
        .main-content {
            flex: 1; padding: 0; overflow-y: auto; overflow-x: hidden; position: relative;
            background: linear-gradient(to bottom, var(--bg-color) 0%, transparent 150px);
        }
        .tab-content { display: none; padding: 2rem 3rem; min-height: 100%; }
        #home-tab { display: block; }

        /* --- CARDS & ROWS --- */
        .row-title { font-size: 1.4rem; font-weight: 500; margin: 2rem 0 1rem 0; letter-spacing: 0.5px; }
        .horizontal-row { display: flex; gap: 1.5rem; padding: 1rem 0.5rem; overflow-x: auto; scroll-behavior: smooth; }
        ::-webkit-scrollbar { display: none; }
        .card {
            flex: 0 0 auto; background-color: var(--surface-variant);
            border-radius: var(--card-radius); overflow: hidden; position: relative;
            border: 4px solid transparent; display: flex; flex-direction: column; justify-content: flex-end;
            transition: transform 0.2s;
        }
        .card-label {
            background: linear-gradient(to top, rgba(0,0,0,0.95), transparent);
            padding: 12px; width: 100%; font-size: 1rem; font-weight: 500;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }

        /* Sizes */
        .card.hero { width: 70vw; height: 45vh; background: url('https://image.tmdb.org/t/p/original/e1mjopzAS2KNsvpbpahQ1a6SkSn.jpg') center/cover; border-radius: 24px; }
        .card.movie { width: 150px; height: 225px; background-color: #333; background-size: cover; }
        .card.episode { width: 260px; height: 146px; background-color: #333; background-size: cover; }
        .card.app { width: 100px; height: 100px; border-radius: 22px; }
        .app-grid { display: flex; gap: 1.5rem; padding: 1rem 0; flex-wrap: wrap; }

        /* Settings */
        .settings-list { display: flex; flex-direction: column; gap: 1rem; max-width: 600px; }
        .settings-item {
            display: flex; align-items: center; background: var(--surface-variant);
            padding: 1rem 1.5rem; border-radius: var(--card-radius); border: 4px solid transparent;
        }

    </style>
</head>
<body>

    <div id="profile-overlay">
        <h1 style="font-weight: 300; font-size: 2.5rem; margin-bottom: 0;">Who's Watching?</h1>
        <div class="profile-grid">
            <div class="profile-item focusable" tabindex="0" data-profile="Dad">
                <div class="profile-avatar"><i class="fas fa-user"></i></div>
                <div class="profile-name">Dad</div>
            </div>
            <div class="profile-item focusable" tabindex="0" data-profile="Kids">
                <div class="profile-avatar"><i class="fas fa-child"></i></div>
                <div class="profile-name">Kids Mode</div>
            </div>
        </div>
    </div>

    <div class="sidebar">
        <div id="btn-profile" class="current-profile-icon focusable" tabindex="0" title="Switch Profile">
            <i class="fas fa-user"></i>
        </div>

        <div class="menu-item focusable active-tab" tabindex="0" data-target="home-tab"><i class="fas fa-home"></i>Home</div>
        <div id="nav-linear" class="menu-item focusable" tabindex="0" data-target="linear-tab"><i class="fas fa-broadcast-tower"></i>Linear</div>
        <div class="menu-item focusable" tabindex="0" data-target="plus-tab"><i class="fas fa-play"></i>Plus</div>
        <div class="menu-item focusable" tabindex="0" data-target="search-tab"><i class="fas fa-search"></i>Search</div>
        
        <div class="settings-spacer"></div>
        <div class="menu-item focusable" tabindex="0" data-target="settings-tab"><i class="fas fa-cog"></i>Settings</div>
    </div>

    <div class="main-content">

        <div id="home-tab" class="tab-content">
            <div class="horizontal-row">
                <div class="card hero focusable" tabindex="0"><div class="card-label">Featured: Suicide Squad Isekai</div></div>
            </div>
            <div class="row-title">Continue Watching</div>
            <div class="horizontal-row">
                <div class="card episode focusable" tabindex="0" style="background-image: url('https://image.tmdb.org/t/p/w500/u3bZgnGQ9T01sWNhyhoKgwsoJw.jpg');">
                    <div class="card-label">The Boys S03E04</div>
                </div>
                <div class="card movie focusable" tabindex="0" style="background-image: url('https://image.tmdb.org/t/p/w500/8CdX3871Cq9UqYt636O27tZ4fN.jpg');"></div>
            </div>
            <div class="row-title">Apps</div>
            <div class="app-grid">
                <div class="card app focusable" tabindex="0" style="background: #E50914; display:grid; place-items:center;"><i class="fab fa-netflix fa-2x"></i></div>
                <div class="card app focusable" tabindex="0" style="background: #FF0000; display:grid; place-items:center;"><i class="fab fa-youtube fa-2x"></i></div>
            </div>
        </div>

        <div id="linear-tab" class="tab-content">
            <h1>TV Guide</h1>
            <p>Channel Grid would go here...</p>
        </div>

        <div id="plus-tab" class="tab-content">
            <h1>On Demand</h1>
            <div class="horizontal-row">
                 <div class="card movie focusable" tabindex="0" style="background-image: url('https://image.tmdb.org/t/p/w500/qA5kPYZA7FkVvqcEfJRoOy4kpHg.jpg');"></div>
                 <div class="card movie focusable" tabindex="0" style="background-image: url('https://image.tmdb.org/t/p/w500/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg');"></div>
            </div>
        </div>

        <div id="search-tab" class="tab-content">
            <h1>Search</h1>
            <input type="text" placeholder="Search..." style="padding:1rem; width:100%; border-radius:30px; border:none; background:#333; color:white;">
        </div>

        <div id="settings-tab" class="tab-content">
            <h1>Settings</h1>
            <div class="settings-list">
                <div class="settings-item focusable" tabindex="0">Profile Settings</div>
                <div class="settings-item focusable" tabindex="0">Parental Controls</div>
            </div>
        </div>

    </div>

    <script>
        const overlay = document.getElementById('profile-overlay');
        const sidebarProfileBtn = document.getElementById('btn-profile');
        const linearTabBtn = document.getElementById('nav-linear');

        // --- 1. PROFILE SELECTION LOGIC ---
        function selectProfile(profileName) {
            console.log("Selected Profile:", profileName);
            
            // Visual Updates based on Profile
            if(profileName === 'Kids') {
                document.body.classList.add('kids-mode');
                linearTabBtn.style.display = 'none'; // Hide Live TV for kids
                sidebarProfileBtn.innerHTML = '<i class="fas fa-child"></i>';
            } else {
                document.body.classList.remove('kids-mode');
                linearTabBtn.style.display = 'flex'; // Show Live TV
                sidebarProfileBtn.innerHTML = '<i class="fas fa-user"></i>';
            }

            // Hide Overlay
            overlay.style.opacity = '0';
            setTimeout(() => {
                overlay.style.display = 'none';
                sidebarProfileBtn.focus(); // Move focus to sidebar
            }, 300);
        }

        // --- 2. SHOW OVERLAY LOGIC ---
        function showProfileOverlay() {
            overlay.style.display = 'flex';
            setTimeout(() => {
                overlay.style.opacity = '1';
                // Focus the first profile item
                const firstProfile = overlay.querySelector('.profile-item');
                if(firstProfile) firstProfile.focus();
            }, 10);
        }

        // --- 3. TAB SWITCHING LOGIC ---
        function activateTab(tabBtn) {
            // Remove active class from all
            document.querySelectorAll('.menu-item').forEach(btn => btn.classList.remove('active-tab'));
            // Add to clicked
            tabBtn.classList.add('active-tab');
            
            // Hide all content
            document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
            // Show target
            const targetId = tabBtn.getAttribute('data-target');
            document.getElementById(targetId).style.display = 'block';
        }

        // --- 4. EVENT LISTENERS ---
        
        // A. Profile Items (In Overlay)
        document.querySelectorAll('.profile-item').forEach(item => {
            // Mouse Click
            item.addEventListener('click', () => selectProfile(item.dataset.profile));
            // Keyboard Enter
            item.addEventListener('keydown', (e) => {
                if(e.key === 'Enter') selectProfile(item.dataset.profile);
            });
        });

        // B. Sidebar Profile Button
        sidebarProfileBtn.addEventListener('click', showProfileOverlay);
        sidebarProfileBtn.addEventListener('keydown', (e) => {
            if(e.key === 'Enter') showProfileOverlay();
        });

        // C. Menu Tabs
        document.querySelectorAll('.menu-item').forEach(item => {
            // Mouse Click
            item.addEventListener('click', () => activateTab(item));
            // Keyboard Enter
            item.addEventListener('keydown', (e) => {
                if(e.key === 'Enter') activateTab(item);
            });
        });

        // D. Focus Management (Visuals)
        document.addEventListener('focusin', (e) => {
            // Clear old focus
            document.querySelectorAll('.focused').forEach(el => el.classList.remove('focused'));
            // Add new focus if focusable
            if(e.target.classList.contains('focusable')) {
                e.target.classList.add('focused');
            }
        });

        // E. On Load
        window.onload = () => {
            // Focus Dad profile initially
            const dadProfile = document.querySelector('.profile-item[data-profile="Dad"]');
            if(dadProfile) dadProfile.focus();
        };

    </script>
</body>
</html>

